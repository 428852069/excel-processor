<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excelæ•¸æ“šè™•ç†å·¥å…·</title>
    <!-- Luckysheet CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/css/pluginsCss.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/plugins.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/css/luckysheet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/assets/iconfont/iconfont.css" />
    <!-- é é¢è‡ªå®šç¾©æ¨£å¼ -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f7;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .description {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        .upload-section {
            text-align: center;
            padding: 25px;
            border: 2px dashed #3498db;
            border-radius: 8px;
            margin-bottom: 30px;
            background-color: #f8fafc;
        }
        #fileInput {
            padding: 10px;
            margin-bottom: 15px;
        }
        #loadBtn {
            background-color: #3498db;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        #loadBtn:hover {
            background-color: #2980b9;
        }
        .tools-section {
            margin: 25px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 5px solid #2ecc71;
        }
        .tools-section h3 {
            margin-top: 0;
            color: #27ae60;
        }
        .custom-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 15px;
        }
        .tool-btn {
            background-color: #2c3e50;
            color: white;
            padding: 10px 18px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            flex-grow: 1;
            min-width: 180px;
        }
        .tool-btn:hover {
            background-color: #34495e;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .tool-btn:nth-child(1) { background-color: #e74c3c; } /* å•é¡Œæ’æŸ¥ */
        .tool-btn:nth-child(1):hover { background-color: #c0392b; }
        .tool-btn:nth-child(2) { background-color: #9b59b6; } /* æª¢é©—å¹´é½¡ */
        .tool-btn:nth-child(2):hover { background-color: #8e44ad; }
        .tool-btn:nth-child(3) { background-color: #3498db; } /* æ¨™è¨˜å…¥åœ˜ */
        .tool-btn:nth-child(3):hover { background-color: #2980b9; }
        .tool-btn:nth-child(4) { background-color: #1abc9c; } /* æ¨™è¨˜ç•¢æ¥­ */
        .tool-btn:nth-child(4):hover { background-color: #16a085; }
        .tool-btn:nth-child(5) { background-color: #f39c12; } /* æª¢é©—ç©æ¥µåˆ†å­ */
        .tool-btn:nth-child(5):hover { background-color: #e67e22; }
        #luckysheet {
            width: 100%;
            height: 600px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 35px;
        }
        .action-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s;
        }
        #downloadBtn {
            background-color: #2ecc71;
            color: white;
        }
        #downloadBtn:hover {
            background-color: #27ae60;
            box-shadow: 0 6px 12px rgba(46, 204, 113, 0.3);
        }
        #submitFormBtn {
            background-color: #e74c3c;
            color: white;
        }
        #submitFormBtn:hover {
            background-color: #c0392b;
            box-shadow: 0 6px 12px rgba(231, 76, 60, 0.3);
        }
        .instructions {
            margin-top: 40px;
            padding: 20px;
            background-color: #fff8e1;
            border-radius: 8px;
            border-left: 5px solid #ffc107;
            font-size: 14px;
            line-height: 1.6;
        }
        .instructions h4 {
            color: #ff9800;
            margin-top: 0;
        }
        .instructions ul {
            padding-left: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š Excel æ•¸æ“šè™•ç†å·¥å…·</h1>
        <p class="description">ä¸Šå‚³ .xlsx æ–‡ä»¶ï¼Œåœ¨ç·šç·¨è¼¯ä¸¦ä½¿ç”¨è‡ªå®šç¾©å·¥å…·è™•ç†ï¼Œå®Œæˆå¾Œä¸‹è¼‰ä¸¦æäº¤ã€‚</p>

        <!-- æ–‡ä»¶ä¸Šå‚³å€ -->
        <div class="upload-section">
            <h3>ç¬¬ä¸€æ­¥ï¼šä¸Šå‚³ Excel æ–‡ä»¶</h3>
            <p>è«‹ç¢ºä¿æ–‡ä»¶æ ¼å¼ç‚º <strong>.xlsx</strong>ï¼ˆExcel 2007+ï¼‰</p>
            <input type="file" id="fileInput" accept=".xlsx">
            <br>
            <button id="loadBtn">åŠ è¼‰åˆ°åœ¨ç·šè¡¨æ ¼</button>
        </div>

        <!-- è‡ªå®šç¾©å·¥å…·æ¬„å€ -->
        <div class="tools-section">
            <h3>ç¬¬äºŒæ­¥ï¼šä½¿ç”¨å·¥å…·è™•ç†æ•¸æ“šï¼ˆé»æ“ŠæŒ‰éˆ•é‹è¡Œè…³æœ¬ï¼‰</h3>
            <div class="custom-toolbar">
                <button class="tool-btn" onclick="runCommonIssueCheck()">ğŸ” å¸¸è¦‹å•é¡Œæ’æŸ¥</button>
                <button class="tool-btn" onclick="checkAgeOver14()">ğŸ‘¤ æª¢é©—æ˜¯å¦æ»¿14å‘¨æ­²</button>
                <button class="tool-btn" onclick="markLeagueMember()">ğŸ… è‡ªå‹•æ¨™è¨˜æ˜¯å¦å…¥åœ˜</button>
                <button class="tool-btn" onclick="markGraduation()">ğŸ“ è‡ªå‹•æ¨™è¨˜æ˜¯å¦ç•¢æ¥­</button>
                <button class="tool-btn" onclick="checkActivistInOtherSchool()">ğŸ“‹ è‡ªå‹•æª¢é©—å…‰å±±ç¸£å…¶ä»–å­¸æ ¡ç©æ¥µåˆ†å­</button>
            </div>
            <p><small>æç¤ºï¼šå·¥å…·è…³æœ¬å°‡ç›´æ¥ä¿®æ”¹ç•¶å‰è¡¨æ ¼å…§å®¹ï¼Œè«‹åœ¨ä½¿ç”¨å‰ä¿å­˜æˆ–å‚™ä»½ã€‚</small></p>
        </div>

        <!-- Luckysheet å®¹å™¨ -->
        <h3>åœ¨ç·šè¡¨æ ¼ç·¨è¼¯å™¨</h3>
        <div id="luckysheet"></div>

        <!-- æœ€çµ‚æ“ä½œæŒ‰éˆ• -->
        <div class="action-buttons">
            <button class="action-btn" id="downloadBtn">ğŸ’¾ ä¸‹è¼‰è™•ç†å¾Œçš„è¡¨æ ¼</button>
            <button class="action-btn" id="submitFormBtn">ğŸš€ è·³è½‰è‡³æäº¤è¡¨å–®</button>
        </div>

        <!-- ä½¿ç”¨èªªæ˜ -->
        <div class="instructions">
            <h4>ğŸ“– ä½¿ç”¨èªªæ˜èˆ‡æ³¨æ„äº‹é …</h4>
            <ul>
                <li><strong>æ–‡ä»¶ä¸Šå‚³</strong>ï¼šåƒ…æ”¯æŒ <code>.xlsx</code> æ ¼å¼ã€‚æ–‡ä»¶å°‡å®Œå…¨åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­è™•ç†ï¼Œä¸æœƒä¸Šå‚³åˆ°ä»»ä½•å¤–éƒ¨æœå‹™å™¨ã€‚</li>
                <li><strong>å·¥å…·æŒ‰éˆ•</strong>ï¼šæ¯å€‹æŒ‰éˆ•å°æ‡‰ä¸€å€‹è‡ªå®šç¾©è…³æœ¬ã€‚æ‚¨éœ€è¦æ ¹æ“šå¯¦éš›è¡¨æ ¼çµæ§‹ï¼ˆåˆ—æ¨™é¡Œã€æ•¸æ“šä½ç½®ï¼‰ä¿®æ”¹å°æ‡‰çš„ <code>runCommonIssueCheck()</code> ç­‰å‡½æ•¸å…§çš„é‚è¼¯ã€‚</li>
                <li><strong>ä¸‹è¼‰</strong>ï¼šé»æ“Šä¸‹è¼‰æŒ‰éˆ•ï¼Œå°‡ç•¶å‰è¡¨æ ¼å…§å®¹å°å‡ºç‚º <code>processed_data.xlsx</code>ã€‚</li>
                <li><strong>æäº¤è¡¨å–®</strong>ï¼šé»æ“Šè·³è½‰æŒ‰éˆ•ï¼Œå°‡å‰å¾€æ‚¨æŒ‡å®šçš„è¡¨å–®é é¢ï¼ˆä¸‹æ–¹ä»£ç¢¼ä¸­éœ€æ›¿æ›ç‚ºæ‚¨çš„å¯¦éš›è¡¨å–®URLï¼‰ï¼Œä¾›ç”¨æˆ¶ä¸Šå‚³è™•ç†å¾Œçš„æ–‡ä»¶ã€‚</li>
                <li><strong>å…¼å®¹æ€§</strong>ï¼šè«‹ä½¿ç”¨ç¾ä»£ç€è¦½å™¨ï¼ˆChrome, Edge, Firefox, Safariï¼‰ä»¥ç²å¾—æœ€ä½³é«”é©—ã€‚</li>
            </ul>
        </div>
    </div>

    <!-- å¼•å…¥å¿…è¦åº« -->
    <!-- Luckysheet ä¾è³´ -->
    <script src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/plugins/js/plugin.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luckysheet@latest/dist/luckysheet.umd.js"></script>
    <!-- SheetJS (xlsx è™•ç†) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- FileSaver.js (æ–‡ä»¶ä¿å­˜) -->
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

    <script>
        // å…¨å±€è®Šé‡ï¼šå­˜å„²Luckysheetå¯¦ä¾‹å’Œç•¶å‰è¡¨æ ¼æ•¸æ“š
        let luckySheetInstance = null;
        let currentWorkbookData = null;

        // 1. åŠ è¼‰ä¸Šå‚³çš„Excelæ–‡ä»¶
        document.getElementById('loadBtn').addEventListener('click', function() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (!file) {
                alert('è«‹å…ˆé¸æ“‡ä¸€å€‹ .xlsx æ–‡ä»¶ï¼');
                return;
            }
            if (!file.name.endsWith('.xlsx')) {
                alert('è«‹é¸æ“‡ .xlsx æ ¼å¼çš„æ–‡ä»¶ï¼');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = e.target.result;
                    // ä½¿ç”¨ SheetJS è§£æ Excel æ–‡ä»¶
                    const workbook = XLSX.read(data, {type: 'binary'});
                    currentWorkbookData = workbook;

                    // å°‡ç¬¬ä¸€å€‹å·¥ä½œè¡¨è½‰æ›ç‚º Luckysheet å¯è­˜åˆ¥çš„ JSON æ ¼å¼
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const sheetData = XLSX.utils.sheet_to_json(worksheet, {header: 1});

                    // æº–å‚™ Luckysheet é…ç½®
                    const options = {
                        container: 'luckysheet',
                        title: file.name,
                        lang: 'zh',
                        showtoolbar: true,
                        showinfobar: true,
                        showsheetbar: true,
                        data: [{
                            name: firstSheetName,
                            celldata: [], // Luckysheet v2 ä½¿ç”¨ data
                            // å°‡äºŒç¶­æ•¸çµ„è½‰æ›ç‚º Luckysheet çš„ data æ ¼å¼
                            data: sheetData,
                            order: 0,
                            row: sheetData.length,
                            column: sheetData.length > 0 ? sheetData[0].length : 10,
                        }],
                    };

                    // åˆå§‹åŒ–æˆ–åŠ è¼‰ Luckysheet
                    if (luckySheetInstance) {
                        luckysheet.destroy();
                    }
                    luckySheetInstance = luckysheet.create(options);
                    alert('æ–‡ä»¶å·²æˆåŠŸåŠ è¼‰ï¼è«‹åœ¨ä¸‹æ–¹è¡¨æ ¼ä¸­ç·¨è¼¯æˆ–ä½¿ç”¨å·¥å…·ã€‚');

                } catch (error) {
                    console.error('è§£ææ–‡ä»¶å‡ºéŒ¯:', error);
                    alert('è§£æExcelæ–‡ä»¶æ™‚å‡ºéŒ¯ï¼Œè«‹æª¢æŸ¥æ–‡ä»¶æ ¼å¼ã€‚');
                }
            };
            reader.readAsBinaryString(file);
        });

        // ============================================
        // 2. è‡ªå®šç¾©å·¥å…·å‡½æ•¸ (æ‚¨éœ€è¦æ ¹æ“šå¯¦éš›è¡¨æ ¼çµæ§‹ä¿®æ”¹å…·é«”é‚è¼¯)
        // ============================================

        /**
         * å·¥å…·1: å¸¸è¦‹å•é¡Œæ’æŸ¥
         * ç¤ºä¾‹ï¼šæª¢æŸ¥å¿…å¡«é …æ˜¯å¦ç‚ºç©ºï¼Œä¸¦åœ¨å‚™è¨»åˆ—æ¨™è¨˜
         */
        function runCommonIssueCheck() {
            if (!luckySheetInstance) {
                alert('è«‹å…ˆåŠ è¼‰ä¸€å€‹è¡¨æ ¼æ–‡ä»¶ï¼');
                return;
            }
            const cellData = luckysheet.getCellValue(); // ç²å–æ‰€æœ‰å–®å…ƒæ ¼æ•¸æ“š
            // TODO: æ ¹æ“šæ‚¨çš„è¡¨æ ¼çµæ§‹ç·¨å¯«å…·é«”çš„æ’æŸ¥é‚è¼¯
            // ä¾‹å¦‚ï¼šå‡è¨­ç¬¬Aåˆ—æ˜¯å§“åï¼ˆç´¢å¼•0ï¼‰ï¼Œç¬¬Båˆ—æ˜¯å­¸è™Ÿï¼ˆç´¢å¼•1ï¼‰
            // éæ­·æ‰€æœ‰è¡Œï¼Œæª¢æŸ¥Aåˆ—å’ŒBåˆ—æ˜¯å¦ç‚ºç©º
            const issues = [];
            for(let i = 0; i < cellData.length; i++) {
                if (!cellData[i] || !cellData[i]['0'] || !cellData[i]['1']) {
                    issues.push(`ç¬¬${i+1}è¡Œï¼šå§“åæˆ–å­¸è™Ÿç‚ºç©º`);
                    // å¯ä»¥åœ¨æŸå€‹å‚™è¨»åˆ—ï¼ˆä¾‹å¦‚ç¬¬Zåˆ—ï¼‰å¯«å…¥æ¨™è¨˜
                    // luckysheet.setCellValue(i, 25, 'âŒ ä¿¡æ¯ä¸å…¨'); // ç¬¬26åˆ—ï¼ˆZï¼‰æ˜¯ç´¢å¼•25
                }
            }
            alert(`å•é¡Œæ’æŸ¥å®Œæˆï¼å…±ç™¼ç¾ ${issues.length} å€‹å•é¡Œã€‚`);
            console.log('ç™¼ç¾çš„å•é¡Œ:', issues);
        }

        /**
         * å·¥å…·2: æª¢é©—æ˜¯å¦æ»¿14å‘¨æ­²
         * å‡è¨­ï¼šCåˆ—æ˜¯å‡ºç”Ÿæ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
         */
        function checkAgeOver14() {
            if (!luckySheetInstance) {
                alert('è«‹å…ˆåŠ è¼‰ä¸€å€‹è¡¨æ ¼æ–‡ä»¶ï¼');
                return;
            }
            const sheet = luckysheet.getSheet(); // ç²å–ç•¶å‰å·¥ä½œè¡¨æ•¸æ“š
            const data = sheet.data;
            let count = 0;
            for(let r = 0; r < data.length; r++) {
                // è·³éè¡¨é ­è¡Œï¼ˆç´¢å¼•0ï¼‰
                if(r === 0) continue;
                const birthDateStr = data[r] && data[r][2]; // å‡è¨­Cåˆ—æ˜¯ç´¢å¼•2
                if(birthDateStr) {
                    const birthDate = new Date(birthDateStr);
                    const today = new Date();
                    let age = today.getFullYear() - birthDate.getFullYear();
                    const m = today.getMonth() - birthDate.getMonth();
                    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                        age--;
                    }
                    // å‡è¨­åœ¨Dåˆ—ï¼ˆç´¢å¼•3ï¼‰å¯«å…¥çµæœ
                    const result = age >= 14 ? 'æ˜¯' : 'å¦';
                    luckysheet.setCellValue(r, 3, result);
                    if(age >= 14) count++;
                }
            }
            alert(`å¹´é½¡æª¢é©—å®Œæˆï¼æ»¿14å‘¨æ­²çš„è¨˜éŒ„æœ‰ ${count} æ¢ã€‚`);
        }

        /**
         * å·¥å…·3: è‡ªå‹•æ¨™è¨˜æ˜¯å¦å…¥åœ˜
         * å‡è¨­ï¼šéœ€è¦æ ¹æ“šå…¶ä»–åˆ—ä¿¡æ¯åˆ¤æ–·ï¼Œä¾‹å¦‚â€œå…¥åœ˜æ™‚é–“â€åˆ—æœ‰å€¼å³ç‚ºå…¥åœ˜
         */
        function markLeagueMember() {
            alert('â€œè‡ªå‹•æ¨™è¨˜æ˜¯å¦å…¥åœ˜â€è…³æœ¬å·²åŸ·è¡Œã€‚\nè«‹æ ¹æ“šæ‚¨çš„è¡¨æ ¼çµæ§‹ä¿®æ”¹æ­¤å‡½æ•¸å…§çš„é‚è¼¯ã€‚');
            // TODO: å¯¦ç¾æ‚¨çš„é‚è¼¯
            // ç¤ºä¾‹ï¼šéæ­·â€œå…¥åœ˜æ™‚é–“â€åˆ—ï¼ˆä¾‹å¦‚Eåˆ—ï¼Œç´¢å¼•4ï¼‰ï¼Œæœ‰å€¼å‰‡åœ¨â€œæ˜¯å¦å…¥åœ˜â€åˆ—ï¼ˆä¾‹å¦‚Fåˆ—ï¼Œç´¢å¼•5ï¼‰æ¨™è¨˜â€œæ˜¯â€
        }

        /**
         * å·¥å…·4: è‡ªå‹•æ¨™è¨˜æ˜¯å¦ç•¢æ¥­
         */
        function markGraduation() {
            alert('â€œè‡ªå‹•æ¨™è¨˜æ˜¯å¦ç•¢æ¥­â€è…³æœ¬å·²åŸ·è¡Œã€‚\nè«‹æ ¹æ“šæ‚¨çš„è¡¨æ ¼çµæ§‹ä¿®æ”¹æ­¤å‡½æ•¸å…§çš„é‚è¼¯ã€‚');
            // TODO: å¯¦ç¾æ‚¨çš„é‚è¼¯
        }

        /**
         * å·¥å…·5: è‡ªå‹•æª¢é©—æ˜¯å¦åœ¨å…‰å±±ç¸£å…¶ä»–å­¸æ ¡ç™¼å±•éç©æ¥µåˆ†å­
         */
        function checkActivistInOtherSchool() {
            alert('â€œæª¢é©—å…‰å±±ç¸£å…¶ä»–å­¸æ ¡ç©æ¥µåˆ†å­â€è…³æœ¬å·²åŸ·è¡Œã€‚\nè«‹æ ¹æ“šæ‚¨çš„è¡¨æ ¼çµæ§‹ä¿®æ”¹æ­¤å‡½æ•¸å…§çš„é‚è¼¯ã€‚');
            // TODO: å¯¦ç¾æ‚¨çš„é‚è¼¯
            // å¯èƒ½éœ€è¦é—œéµè©åŒ¹é…æˆ–å¤–éƒ¨æ•¸æ“šå°æ¯”
        }

        // ============================================
        // 3. ä¸‹è¼‰è™•ç†å¾Œçš„è¡¨æ ¼
        // ============================================
        document.getElementById('downloadBtn').addEventListener('click', function() {
            if (!luckySheetInstance) {
                alert('æ²’æœ‰å¯ä¸‹è¼‰çš„è¡¨æ ¼æ•¸æ“šï¼è«‹å…ˆåŠ è¼‰æ–‡ä»¶ã€‚');
                return;
            }

            try {
                // ç²å– Luckysheet ç•¶å‰æ•¸æ“š
                const sheet = luckysheet.getSheet();
                const sheetArray = luckysheet.getSheetData(); // ç²å–äºŒç¶­æ•¸çµ„æ ¼å¼çš„æ•¸æ“š

                // å°‡äºŒç¶­æ•¸çµ„è½‰æ›ç‚º SheetJS å·¥ä½œè¡¨å°è±¡
                const ws = XLSX.utils.aoa_to_sheet(sheetArray);
                // å‰µå»ºä¸€å€‹æ–°çš„å·¥ä½œç°¿
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Processed_Sheet");

                // ç”ŸæˆExcelæ–‡ä»¶äºŒé€²åˆ¶æ•¸æ“š
                const wbout = XLSX.write(wb, {bookType:'xlsx', type:'binary'});
                // ä½¿ç”¨ FileSaver ä¿å­˜æ–‡ä»¶
                const blob = new Blob([s2ab(wbout)], {type:"application/octet-stream"});
                saveAs(blob, `processed_data_${new Date().getTime()}.xlsx`);
                alert('æ–‡ä»¶å·²é–‹å§‹ä¸‹è¼‰ï¼');

            } catch (error) {
                console.error('å°å‡ºæ–‡ä»¶æ™‚å‡ºéŒ¯:', error);
                alert('å°å‡ºæ–‡ä»¶æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æŸ¥çœ‹æ§åˆ¶å°ã€‚');
            }
        });

        // è¼”åŠ©å‡½æ•¸ï¼šå°‡å­—ç¬¦ä¸²è½‰æ›ç‚º ArrayBuffer
        function s2ab(s) {
            const buf = new ArrayBuffer(s.length);
            const view = new Uint8Array(buf);
            for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
            return buf;
        }

        // ============================================
        // 4. è·³è½‰è‡³æäº¤è¡¨å–®
        // ============================================
        document.getElementById('submitFormBtn').addEventListener('click', function() {
            // !!! é‡è¦ï¼šè«‹å°‡ä¸‹é¢çš„ URL æ›¿æ›ç‚ºæ‚¨å¯¦éš›çš„è¡¨å–®åœ°å€ !!!
            const formUrl = "https://f.wps.cn/g/JaaWyioV/"; // <-- æ›¿æ›æ­¤è¡Œ
            const confirmJump = confirm(`è™•ç†å®Œæˆå¾Œï¼Œè«‹ä¸‹è¼‰æ–‡ä»¶ã€‚\né»æ“Šâ€œç¢ºå®šâ€å°‡è·³è½‰è‡³æäº¤è¡¨å–®é é¢ã€‚\n\nè¡¨å–®URLï¼š${formUrl}`);
            if (confirmJump) {
                window.open(formUrl, '_blank');
            }
        });

        // é é¢åŠ è¼‰å®Œæˆå¾Œï¼Œå¯ä»¥é€²è¡Œä¸€äº›åˆå§‹æç¤ºï¼ˆå¯é¸ï¼‰
        window.addEventListener('DOMContentLoaded', (event) => {
            console.log('Excelè™•ç†å·¥å…·é é¢å·²åŠ è¼‰ã€‚è«‹ä¸Šå‚³ .xlsx æ–‡ä»¶é–‹å§‹ä½¿ç”¨ã€‚');
        });
    </script>
</body>
</html>
