<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨çº¿è¡¨æ ¼è‡ªåŠ¨åŒ–å¤„ç†ä¸­å¿ƒ</title>
    <!-- 1. å¼•å…¥ Handsontable çš„æ ·å¼æ–‡ä»¶ (æä¾›Excelèˆ¬çš„ç•Œé¢) -->
    <link href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" rel="stylesheet">
    <style>
        /* åŸºæœ¬é¡µé¢æ ·å¼ */
        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        body { margin: 20px; background-color: #f5f7fa; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 2px 12px rgba(0,0,0,0.1); padding: 25px; }
        header { text-align: center; margin-bottom: 30px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        header h1 { color: #2c3e50; margin-bottom: 5px; }
        header p { color: #7f8c8d; font-size: 1.1em; }

        /* åŠŸèƒ½åŒºæ ·å¼ */
        .control-panel { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 25px; padding: 20px; background: #f8f9fa; border-radius: 6px; align-items: center; }
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; transition: all 0.2s; }
        .btn-primary { background-color: #007bff; color: white; }
        .btn-primary:hover { background-color: #0056b3; }
        .btn-secondary { background-color: #6c757d; color: white; }
        .btn-secondary:hover { background-color: #545b62; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-success:hover { background-color: #1e7e34; }
        .btn-warning { background-color: #ffc107; color: #212529; }
        .btn-warning:hover { background-color: #d39e00; }
        .btn-danger { background-color: #dc3545; color: white; }
        .btn-danger:hover { background-color: #bd2130; }
        .file-input-wrapper { flex-grow: 1; }
        .file-input-wrapper input[type="file"] { padding: 8px; border: 1px solid #ddd; border-radius: 5px; width: 100%; }

        /* å·¥å…·æ æ ·å¼ */
        .toolbar { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; padding: 15px; background: #e9ecef; border-radius: 6px; }
        .toolbar-label { font-weight: bold; color: #495057; margin-right: 10px; align-self: center; }

        /* è¡¨æ ¼ç¼–è¾‘åŒºæ ·å¼ */
        #excelEditorContainer { height: 500px; margin-bottom: 20px; border: 1px solid #dee2e6; border-radius: 6px; overflow: hidden; }
        .hot { /* Handsontable è¡¨æ ¼æ ·å¼ï¼Œè¿™é‡Œå¯ä»¥è‡ªå®šä¹‰ */ }

        /* æäº¤ä¸ä¸‹è½½åŒº */
        .submit-area { text-align: center; padding-top: 20px; border-top: 1px solid #eee; }
        .instructions { background-color: #e7f3ff; padding: 15px; border-radius: 6px; margin-top: 20px; border-left: 4px solid #007bff; }
        .instructions p { margin: 5px 0; font-size: 0.95em; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“Š åœ¨çº¿è¡¨æ ¼è‡ªåŠ¨åŒ–å¤„ç†ä¸­å¿ƒ</h1>
            <p>ä¸Šä¼ Excelæ–‡ä»¶ï¼Œä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·å¤„ç†ï¼Œç¼–è¾‘åä¸€é”®æäº¤</p>
        </header>

        <!-- 1. ä¸Šä¼ æ–‡ä»¶åŒº -->
        <div class="control-panel">
            <input type="file" id="fileInput" class="btn-secondary" accept=".xlsx, .xls">
            <button onclick="loadFile()" class="btn btn-primary">ğŸ“ åŠ è½½åˆ°è¡¨æ ¼</button>
            <button onclick="saveFile()" class="btn btn-success">ğŸ’¾ ä¸‹è½½å½“å‰è¡¨æ ¼</button>
            <button onclick="clearData()" class="btn btn-danger">ğŸ—‘ï¸ æ¸…ç©ºè¡¨æ ¼</button>
        </div>

        <!-- 2. å·¥å…·æ ï¼ˆä½ çš„å››ä¸ªè„šæœ¬æŒ‰é’®åœ¨è¿™é‡Œï¼‰ -->
        <div class="toolbar">
            <div class="toolbar-label">ğŸ”§ è‡ªåŠ¨åŒ–å·¥å…·ï¼š</div>
            <button onclick="checkAge()" class="btn btn-warning">æ£€éªŒæ˜¯å¦æ»¡14å‘¨å²</button>
            <button onclick="markLeague()" class="btn btn-warning">è‡ªåŠ¨æ ‡è®°æ˜¯å¦å…¥å›¢</button>
            <button onclick="markGraduation()" class="btn btn-warning">è‡ªåŠ¨æ ‡è®°æ˜¯å¦æ¯•ä¸š</button>
            <button onclick="checkActivity()" class="btn btn-warning">æ£€éªŒå…‰å±±å¿è·¨æ ¡ç§¯æåˆ†å­</button>
            <!-- å¯ä»¥ç»§ç»­æ·»åŠ æ›´å¤šå·¥å…·æŒ‰é’® -->
        </div>

        <!-- 3. è¡¨æ ¼ç¼–è¾‘åŒºï¼ˆæ ¸å¿ƒåŒºåŸŸï¼Œæ–‡ä»¶å°†åœ¨è¿™é‡Œæ¸²æŸ“å’Œç¼–è¾‘ï¼‰ -->
        <h3>åœ¨çº¿ç¼–è¾‘åŒº</h3>
        <div id="excelEditorContainer"></div>

        <!-- 4. æäº¤ä¸ä¸‹è½½åŒº -->
        <div class="submit-area">
            <button onclick="submitToCollectForm()" class="btn btn-success" style="padding: 12px 30px; font-size: 1.1em;">
                âœ… å¤„ç†å®Œæˆï¼Œç‚¹å‡»æäº¤
            </button>
            <p style="color:#6c757d; margin-top: 8px;">ç‚¹å‡»åï¼Œå°†è‡ªåŠ¨è·³è½¬åˆ°æ–‡ä»¶æ”¶é›†é¡µé¢</p>
        </div>

        <!-- 5. ä½¿ç”¨è¯´æ˜ -->
        <div class="instructions">
            <p><strong>ä½¿ç”¨æµç¨‹ï¼š</strong></p>
            <p>1. ä¸Šä¼ Excelæ–‡ä»¶ -> 2. ç‚¹å‡»â€œåŠ è½½åˆ°è¡¨æ ¼â€ -> 3. åœ¨è¡¨æ ¼ä¸­ç›´æ¥ç¼–è¾‘ï¼ˆåŒå‡»å•å…ƒæ ¼ï¼‰ -> 4. ä½¿ç”¨ä¸Šæ–¹å·¥å…·æ çš„è‡ªåŠ¨åŒ–å·¥å…·å¤„ç† -> 5. ç‚¹å‡»â€œä¸‹è½½å½“å‰è¡¨æ ¼â€å¤‡ä»½ -> 6. ç‚¹å‡»â€œæäº¤â€æŒ‰é’®è·³è½¬åˆ°æ”¶é›†è¡¨</p>
        </div>
    </div>

    <!-- 2. å¼•å…¥ SheetJS åº“ (å¤„ç†Excelæ–‡ä»¶) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- 3. å¼•å…¥ Handsontable åº“ (æä¾›Webè¡¨æ ¼ç¼–è¾‘) -->
    <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>

    <script>
        // --- å…¨å±€å˜é‡ ---
        let hot; // Handsontable å®ä¾‹
        let currentData = []; // å½“å‰è¡¨æ ¼æ•°æ®
        let currentFileName = '';

        // --- Handsontable åˆå§‹åŒ– ---
        document.addEventListener('DOMContentLoaded', function () {
            const container = document.getElementById('excelEditorContainer');
            hot = new Handsontable(container, {
                // åˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºè¡¨æ ¼
                data: currentData,
                rowHeaders: true, // æ˜¾ç¤ºè¡Œå·
                colHeaders: true, // æ˜¾ç¤ºåˆ—æ ‡ A, B, C...
                height: '100%', // å¡«æ»¡å®¹å™¨é«˜åº¦
                width: '100%',
                licenseKey: 'non-commercial-and-evaluation', // å…è´¹æˆæƒï¼Œç”¨äºéå•†ä¸šé¡¹ç›®
                manualRowResize: true, // å…è®¸æ‰‹åŠ¨è°ƒæ•´è¡Œé«˜
                manualColumnResize: true, // å…è®¸æ‰‹åŠ¨è°ƒæ•´åˆ—å®½
                contextMenu: true, // å¯ç”¨å³é”®èœå•ï¼ˆå¤åˆ¶ã€ç²˜è´´ç­‰ï¼‰
                filters: false, // æ˜¯å¦å¯ç”¨ç­›é€‰
                dropdownMenu: false, // æ˜¯å¦å¯ç”¨ä¸‹æ‹‰èœå•
                columnSorting: true, // å¯ç”¨åˆ—æ’åº
                // ... æ›´å¤šé…ç½®å¯æ ¹æ®éœ€è¦æ·»åŠ 
            });
        });

        // --- æ ¸å¿ƒåŠŸèƒ½å‡½æ•°ï¼ˆç›®å‰æ˜¯éª¨æ¶ï¼Œåç»­å°†å¡«å……é€»è¾‘ï¼‰---
        // 1. åŠ è½½Excelæ–‡ä»¶åˆ°è¡¨æ ¼
        function loadFile() {
            alert('loadFile åŠŸèƒ½ï¼šä» input è¯»å–æ–‡ä»¶ï¼Œç”¨ SheetJS è§£æï¼Œå°†æ•°æ®åŠ è½½åˆ° Handsontable ä¸­ã€‚');
        }
        // 2. ä»è¡¨æ ¼ä¸‹è½½Excelæ–‡ä»¶
        function saveFile() {
            alert('saveFile åŠŸèƒ½ï¼šä» Handsontable è·å–æ•°æ®ï¼Œç”¨ SheetJS ç”Ÿæˆ .xlsx æ–‡ä»¶å¹¶ä¸‹è½½ã€‚');
        }
        // 3. æ¸…ç©ºè¡¨æ ¼
        function clearData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºå½“å‰è¡¨æ ¼æ•°æ®å—ï¼Ÿ')) {
                hot.loadData([]);
                currentData = [];
            }
        }
        // 4. ä½ çš„å››ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬å‡½æ•°
        function checkAge() { alert('checkAgeï¼šéå†æ•°æ®ï¼Œè®¡ç®—å¹´é¾„ï¼Œæ–°å¢â€œæ˜¯å¦æ»¡14å‘¨å²â€åˆ—å¹¶æ ‡è®°ã€‚'); }
        function markLeague() { alert('markLeagueï¼šæ ¹æ®æ¡ä»¶ï¼Œæ–°å¢â€œæ˜¯å¦å…¥å›¢â€åˆ—å¹¶æ ‡è®°ã€‚'); }
        function markGraduation() { alert('markGraduationï¼šæ ¹æ®æ¡ä»¶ï¼Œæ–°å¢â€œæ˜¯å¦æ¯•ä¸šâ€åˆ—å¹¶æ ‡è®°ã€‚'); }
        function checkActivity() { alert('checkActivityï¼šæ ¹æ®â€œå­¦æ ¡â€å’Œâ€œå‘å±•çŠ¶æ€â€ç­‰åˆ—ï¼Œæ ‡è®°è·¨æ ¡æƒ…å†µã€‚'); }
        // 5. æäº¤åŠŸèƒ½ï¼ˆè‡ªåŠ¨è·³è½¬ï¼‰
        function submitToCollectForm() {
            const collectFormUrl = 'https://f.wps.cn/xxxxx'; // è¯·æ›¿æ¢ä¸ºä½ å®é™…çš„æ”¶é›†è¡¨é“¾æ¥
            if (confirm('è¡¨æ ¼å¤„ç†å®Œæˆäº†å—ï¼Ÿç‚¹å‡»â€œç¡®å®šâ€å°†è‡ªåŠ¨è·³è½¬åˆ°æ”¶é›†è¡¨é¡µé¢ã€‚')) {
                // å…ˆä¿å­˜å½“å‰æ•°æ®
                saveFile();
                // è‡ªåŠ¨è·³è½¬
                window.open(collectFormUrl, '_blank');
            }
        }
    </script>
</body>
</html>
